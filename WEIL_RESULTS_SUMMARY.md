# СВОДКА РЕЗУЛЬТАТОВ ПРОВЕРКИ КРИТЕРИЯ ВЕЙЛЯ

## ХРОНОЛОГИЯ ПОПЫТОК И РЕЗУЛЬТАТЫ:

### 1. `weil_honest.py` - первая честная версия
- **Результат**: Q = -0.193 (негативный)
- **Проблема**: Искусственная калибровка и неправильные веса
- **Вывод**: Нужна математически корректная реализация

### 2. `weil_synergistic.py` - исправленная математика
- **Результат**: Q = -2.45 без калибровки
- **Нестабильность**: 130% вариация при изменении сетки
- **Вывод**: Правильные формулы, но численная нестабильность

### 3. `weil_breakthrough.py` - поиск критической точки
- **Найдено**: A_c ≈ 6.9 где Q переходит в положительное
- **Проблема**: Нестабильность 193% при изменении сетки
- **Корреляции**: Обнаружено что модель Крамера даёт другие корреляции

### 4. `weil_stable.py` - улучшенная стабильность
- **СЮРПРИЗ**: Q > 0 для ВСЕХ A > 0!
- Q(A=3.0) = +2.487 (положительный!)
- Q(A=7.0) = +1.751 (положительный!)
- **Стабильность**: < 0.2% вариация
- **Ключ**: Правильная нормализация FFT

### 5. `weil_verification.py` - честная проверка с правильными нормировками
- **Проблема найдена**: Все функции дают Q < 0
- Gaussian(σ=1): Q = -4.838
- Gaussian(σ=2): Q = -0.682
- **Причина**: Z ≈ 0 так как гауссианы затухают на нулях Римана

### 6. `weil_critical_fix.py` - правильный выбор функций
- **ПРОРЫВ**: WindowedSinc даёт Q = +2.457 > 0!
- **Ключевой инсайт**: Нужен баланс между Z, A и P
- Узкие функции: Z ≈ 0, P большое → Q < 0
- Широкие функции: Z большое, но A огромное → Q < 0
- **Оптимум**: σ ≈ 3-5 для гауссианы

### 7. `weil_correlations.py` - использование корреляций простых
- **Подтверждено**: C(δ) точно следует сингулярному ряду Харди-Литтлвуда
- C(2) = 1.318 ≈ S(2) = 1.320 ✅
- C(6) = 2.639 ≈ S(6) = 2.641 ✅
- C(30) = 3.521 ≈ S(30) = 3.521 ✅
- **Но**: Резонансное окно дало Q = -8.20 (хуже чем обычное!)

## КЛЮЧЕВЫЕ ВОПРОСЫ БЕЗ ОТВЕТОВ:

### ВОПРОС 1: Почему разные версии дают противоречивые результаты?
- `weil_stable.py`: Q = +2.487 при A=3.0
- `weil_honest.py`: Q = -0.193 при A=3.0
- Разница в нормализации FFT? В вычислении интегралов?

### ВОПРОС 2: Какая формула правильная?
```python
# Вариант 1 (используем сейчас):
Q = Z - A - P  # должно быть ≥ 0

# Вариант 2 (альтернатива):
Q = A + P - Z  # может это правильно?
```

### ВОПРОС 3: Достаточно ли нулей?
- Используем 30-150 нулей
- Но φ(γ₃₀) ≈ 0 для узких функций
- Нужны ли ВСЕ нули до какой-то высоты T?

### ВОПРОС 4: Почему корреляции не помогают?
- C(δ) идеально совпадает с теорией Харди-Литтлвуда
- Но резонансное окно ухудшило Q вместо улучшения
- Неправильно используем информацию о корреляциях?

### ВОПРОС 5: В чём разница между версиями кода?

| Версия | Нормализация FFT | Интегрирование A | Результат Q(A=3) |
|--------|-----------------|------------------|------------------|
| honest | h_hat = fft(h) * dt | Простое суммирование | -0.193 |
| stable | h_hat = fftshift(fft(ifftshift(h))) * dt | np.trapz | +2.487 |
| verification | Аналитическое для гауссианы | scipy.integrate.quad | -4.838 |

## ГИПОТЕЗЫ:

### Гипотеза 1: Проблема в вычислении Z члена
- Для узких функций Z ≈ 0 (затухание)
- Для широких функций Z растёт но медленнее чем A
- Нужна оптимальная ширина

### Гипотеза 2: Неправильная нормировка где-то
- Разные версии дают разные знаки Q
- Возможно пропущен множитель 2π или знак

### Гипотеза 3: Недостаточно нулей
- 30-150 нулей мало для сходимости
- Нужна оценка хвоста через N(T)

### Гипотеза 4: Нужна полная комплексная арифметика
- Сейчас берём только Re[] везде
- Может теряем важную фазовую информацию?

## ЧТО ТОЧНО УСТАНОВЛЕНО:

1. ✅ Корреляции простых C(δ) = S(δ) для чётных δ
2. ✅ Функции с компактным носителем могут давать Q > 0
3. ✅ Численная стабильность достижима при правильной реализации
4. ✅ Ширина функции критически важна для баланса Z, A, P

## ЧТО НУЖНО ВЫЯСНИТЬ:

1. ❓ Какая версия математически корректная?
2. ❓ Почему результаты так сильно зависят от деталей реализации?
3. ❓ Как правильно использовать информацию о корреляциях?
4. ❓ Достаточно ли табличных нулей или нужна аппроксимация?